{% set pyproject = load_file_data("../../../pyproject.toml", from_recipe_dir=True)  %}
{% set proj = pyproject.get('project') %}

package:
  name: {{ proj.get('name') }}
  version: {{ proj.get('version') }}

source:
  git_url: ../../..

requirements:
  build:
    - python
    - {{ compiler('c') }}
    - numpy >=1.25,<3
    - setuptools
  host:
    - python
    - numpy >=1.25,<3
    - setuptools
  run:
    - python
    - numpy >=1.25,<3
    - scipy
    - matplotlib
    - pyqt <6
    - pyyaml
    - requests
    - pyproj
    - jinja2

build:
  script: {{PYTHON}} -m pip install --no-deps --no-build-isolation .
  entry_points:
  {% for module, entrypoints in proj.get('entry-points').items() %}
  {% for name, path in entrypoints.items() %}
    - {{ name }} = {{ path }}
  {% endfor %}
  {% endfor %}

test:
  source_files:
    - test
  requires:
    - pytest
  imports:
    - pyrocko
  commands:
    - python -m pytest test/base/test_util.py test/base/test_guts.py test/base/test_eikonal.py

about:
  home: https://pyrocko.org
  license: GPL3
  license-family: GPL
  summary: A versatile seismology toolkit for Python.
  doc_url: https://pyrocko.org/docs
